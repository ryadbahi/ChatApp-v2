import{j as R}from"./ui-vendor-BEMU751j.js";import{j as Lt,e as Wt,f as Tt,g as Bt,r as W,k as Ot,R as Ft}from"./react-vendor-oin3n_bH.js";import{z as kt,m as Xt,s as $}from"./auth-CEE9aHD-.js";import Yt from"./RichMessageInput-lNo7FsMt.js";import{f as It}from"./chat-xRr-uYkC.js";import{b as gt,i as qt}from"./social-PyUT3FD-.js";import"./socket-vendor-BLRFddlS.js";import"./editor-vendor-DpIsqUJN.js";const Gt=({otherUser:i,isOnline:n,isMinimized:e,onMinimize:t,onClose:r})=>R.jsxs("div",{className:"dm-window-header flex items-center justify-between p-3 bg-white/5 border-b border-white/20 cursor-move",children:[R.jsxs("div",{className:"flex items-center gap-3",children:[i.avatar?R.jsx("img",{src:i.avatar,alt:i.username,className:"w-8 h-8 rounded-full border-2 border-white/20"}):R.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-pink-400 to-purple-500 flex items-center justify-center border-2 border-white/20",children:R.jsx("span",{className:"text-white text-sm font-medium",children:i.username.charAt(0).toUpperCase()})}),R.jsxs("div",{children:[R.jsxs("div",{className:"flex items-center gap-2",children:[R.jsx("h3",{className:"text-white font-medium text-sm",children:i.username}),R.jsx("span",{className:`inline-block w-2 h-2 rounded-full ml-1 ${n?"bg-green-400":"bg-gray-300"}`,title:n?"Online":"Offline"})]}),R.jsx("p",{className:"text-white/60 text-xs",children:"Direct Message"})]})]}),R.jsxs("div",{className:"flex items-center gap-2",children:[R.jsx("button",{onClick:t,className:"p-1 text-white/70 hover:text-white hover:bg-white/10 rounded transition-colors",title:e?"Restore":"Minimize",children:R.jsx(kt,{className:"text-xs"})}),R.jsx("button",{onClick:r,className:"p-1 text-white/70 hover:text-white hover:bg-white/10 rounded transition-colors",title:"Close",children:R.jsx(Xt,{className:"text-xs"})})]})]}),$t=({messages:i,currentUser:n,formatDate:e,formatTime:t,shouldShowDateSeparator:r,messagesEndRef:o,messagesContainerRef:a,handleScroll:l,loading:g,page:c,hasMore:S,loadMoreMessages:f})=>R.jsxs("div",{ref:a,onScroll:l,className:"flex-1 overflow-y-auto p-3 space-y-2",children:[g&&c===1&&R.jsx("div",{className:"flex items-center justify-center py-4",children:R.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-white"})}),S&&c>1&&R.jsx("div",{className:"text-center py-2",children:R.jsx("button",{onClick:f,disabled:g,className:"text-white/60 hover:text-white text-xs transition-colors",children:g?"Loading...":"Load more messages"})}),i.map((m,x)=>{const b=m.sender._id===n._id,D=i[x-1],y=r(m,D),p=()=>{o.current?.scrollIntoView({behavior:"smooth"})},d=u=>/\.(gif|jpe?g|png|webp|bmp|svg)(\?.*)?$/i.test(u)||/tenor\.com\//i.test(u);return R.jsxs("div",{children:[y&&R.jsx("div",{className:"flex items-center justify-center my-4",children:R.jsx("div",{className:"bg-white/10 text-white/60 text-xs px-3 py-1 rounded-full",children:e(m.createdAt)})}),R.jsx("div",{className:`flex ${b?"justify-end":"justify-start"}`,children:R.jsxs("div",{className:`max-w-[80%] ${b?"order-2":"order-1"}`,children:[R.jsxs("div",{className:`p-3 rounded-lg ${b?"bg-purple-500/30 text-white border border-purple-400/30":"bg-white/10 text-white border border-white/20"}`,children:[m.imageUrl&&R.jsx("img",{src:m.imageUrl,alt:"Shared media",className:"w-40 h-40 object-contain rounded-lg mb-2",onLoad:p}),m.content&&d(m.content.trim())?R.jsx("img",{src:m.content.trim(),alt:"GIF",className:"w-40 h-40 object-contain rounded-lg mb-2",onLoad:p}):m.content?R.jsx("p",{className:"text-sm break-words",dangerouslySetInnerHTML:{__html:m.content}}):null]}),R.jsxs("div",{className:`flex items-center gap-1 mt-1 text-xs text-white/50 ${b?"justify-end":"justify-start"}`,children:[R.jsx("span",{children:t(m.createdAt)}),b&&m.readAt&&R.jsx("span",{className:"text-green-400",children:"✓✓"}),b&&!m.readAt&&R.jsx("span",{className:"text-white/50",children:"✓"})]})]})})]},m._id)}),R.jsx("div",{ref:o})]}),Ut=({onSend:i})=>R.jsx("div",{className:"p-3 border-t border-white/20",children:R.jsx(Yt,{onSend:i})}),Vt=({otherUser:i,isOnline:n,onRestore:e})=>R.jsxs("div",{className:"flex items-center justify-center w-full h-full cursor-pointer bg-white/10 backdrop-blur-md rounded-lg border border-white/20 shadow-xl",onClick:e,title:`Click to restore chat with ${i.username}`,children:[i.avatar?R.jsx("img",{src:i.avatar,alt:i.username,className:"w-10 h-10 rounded-full border-2 border-white/20"}):R.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-pink-400 to-purple-500 flex items-center justify-center border-2 border-white/20",children:R.jsx("span",{className:"text-white text-lg font-medium",children:i.username.charAt(0).toUpperCase()})}),R.jsx("span",{className:`ml-2 w-3 h-3 rounded-full border-2 border-white ${n?"bg-green-400":"bg-gray-400"}`,title:n?"Online":"Offline"})]});var Q={exports:{}},lt={},ht={exports:{}},dt,mt;function Kt(){if(mt)return dt;mt=1;var i="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return dt=i,dt}var ut,vt;function Zt(){if(vt)return ut;vt=1;var i=Kt();function n(){}function e(){}return e.resetWarningCache=n,ut=function(){function t(a,l,g,c,S,f){if(f!==i){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}t.isRequired=t;function r(){return t}var o={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:r,element:t,elementType:t,instanceOf:r,node:t,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:e,resetWarningCache:n};return o.PropTypes=o,o},ut}var yt;function Ht(){return yt||(yt=1,ht.exports=Zt()()),ht.exports}const Jt=Lt(It);var O={},K={},bt;function ot(){if(bt)return K;bt=1,Object.defineProperty(K,"__esModule",{value:!0}),K.dontSetMe=r,K.findInArray=i,K.int=t,K.isFunction=n,K.isNum=e;function i(o,a){for(let l=0,g=o.length;l<g;l++)if(a.apply(a,[o[l],l,o]))return o[l]}function n(o){return typeof o=="function"||Object.prototype.toString.call(o)==="[object Function]"}function e(o){return typeof o=="number"&&!isNaN(o)}function t(o){return parseInt(o,10)}function r(o,a,l){if(o[a])return new Error("Invalid prop ".concat(a," passed to ").concat(l," - do not set this, set it on the child."))}return K}var Z={},wt;function Qt(){if(wt)return Z;wt=1,Object.defineProperty(Z,"__esModule",{value:!0}),Z.browserPrefixToKey=e,Z.browserPrefixToStyle=t,Z.default=void 0,Z.getPrefix=n;const i=["Moz","Webkit","O","ms"];function n(){var o;let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window>"u")return"";const l=(o=window.document)===null||o===void 0||(o=o.documentElement)===null||o===void 0?void 0:o.style;if(!l||a in l)return"";for(let g=0;g<i.length;g++)if(e(a,i[g])in l)return i[g];return""}function e(o,a){return a?"".concat(a).concat(r(o)):o}function t(o,a){return a?"-".concat(a.toLowerCase(),"-").concat(o):o}function r(o){let a="",l=!0;for(let g=0;g<o.length;g++)l?(a+=o[g].toUpperCase(),l=!1):o[g]==="-"?l=!0:a+=o[g];return a}return Z.default=n(),Z}var xt;function ft(){if(xt)return O;xt=1,Object.defineProperty(O,"__esModule",{value:!0}),O.addClassName=w,O.addEvent=l,O.addUserSelectStyles=u,O.createCSSTransform=b,O.createSVGTransform=D,O.getTouch=p,O.getTouchIdentifier=d,O.getTranslation=y,O.innerHeight=f,O.innerWidth=m,O.matchesSelector=o,O.matchesSelectorAndParentsTo=a,O.offsetXYFromParent=x,O.outerHeight=c,O.outerWidth=S,O.removeClassName=M,O.removeEvent=g,O.removeUserSelectStyles=v;var i=ot(),n=t(Qt());function e(s){if(typeof WeakMap!="function")return null;var h=new WeakMap,z=new WeakMap;return(e=function(_){return _?z:h})(s)}function t(s,h){if(s&&s.__esModule)return s;if(s===null||typeof s!="object"&&typeof s!="function")return{default:s};var z=e(h);if(z&&z.has(s))return z.get(s);var _={},C=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var N in s)if(N!=="default"&&Object.prototype.hasOwnProperty.call(s,N)){var T=C?Object.getOwnPropertyDescriptor(s,N):null;T&&(T.get||T.set)?Object.defineProperty(_,N,T):_[N]=s[N]}return _.default=s,z&&z.set(s,_),_}let r="";function o(s,h){return r||(r=(0,i.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(z){return(0,i.isFunction)(s[z])})),(0,i.isFunction)(s[r])?s[r](h):!1}function a(s,h,z){let _=s;do{if(o(_,h))return!0;if(_===z)return!1;_=_.parentNode}while(_);return!1}function l(s,h,z,_){if(!s)return;const C={capture:!0,..._};s.addEventListener?s.addEventListener(h,z,C):s.attachEvent?s.attachEvent("on"+h,z):s["on"+h]=z}function g(s,h,z,_){if(!s)return;const C={capture:!0,..._};s.removeEventListener?s.removeEventListener(h,z,C):s.detachEvent?s.detachEvent("on"+h,z):s["on"+h]=null}function c(s){let h=s.clientHeight;const z=s.ownerDocument.defaultView.getComputedStyle(s);return h+=(0,i.int)(z.borderTopWidth),h+=(0,i.int)(z.borderBottomWidth),h}function S(s){let h=s.clientWidth;const z=s.ownerDocument.defaultView.getComputedStyle(s);return h+=(0,i.int)(z.borderLeftWidth),h+=(0,i.int)(z.borderRightWidth),h}function f(s){let h=s.clientHeight;const z=s.ownerDocument.defaultView.getComputedStyle(s);return h-=(0,i.int)(z.paddingTop),h-=(0,i.int)(z.paddingBottom),h}function m(s){let h=s.clientWidth;const z=s.ownerDocument.defaultView.getComputedStyle(s);return h-=(0,i.int)(z.paddingLeft),h-=(0,i.int)(z.paddingRight),h}function x(s,h,z){const C=h===h.ownerDocument.body?{left:0,top:0}:h.getBoundingClientRect(),N=(s.clientX+h.scrollLeft-C.left)/z,T=(s.clientY+h.scrollTop-C.top)/z;return{x:N,y:T}}function b(s,h){const z=y(s,h,"px");return{[(0,n.browserPrefixToKey)("transform",n.default)]:z}}function D(s,h){return y(s,h,"")}function y(s,h,z){let{x:_,y:C}=s,N="translate(".concat(_).concat(z,",").concat(C).concat(z,")");if(h){const T="".concat(typeof h.x=="string"?h.x:h.x+z),L="".concat(typeof h.y=="string"?h.y:h.y+z);N="translate(".concat(T,", ").concat(L,")")+N}return N}function p(s,h){return s.targetTouches&&(0,i.findInArray)(s.targetTouches,z=>h===z.identifier)||s.changedTouches&&(0,i.findInArray)(s.changedTouches,z=>h===z.identifier)}function d(s){if(s.targetTouches&&s.targetTouches[0])return s.targetTouches[0].identifier;if(s.changedTouches&&s.changedTouches[0])return s.changedTouches[0].identifier}function u(s){if(!s)return;let h=s.getElementById("react-draggable-style-el");h||(h=s.createElement("style"),h.type="text/css",h.id="react-draggable-style-el",h.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,h.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,s.getElementsByTagName("head")[0].appendChild(h)),s.body&&w(s.body,"react-draggable-transparent-selection")}function v(s){if(s)try{if(s.body&&M(s.body,"react-draggable-transparent-selection"),s.selection)s.selection.empty();else{const h=(s.defaultView||window).getSelection();h&&h.type!=="Caret"&&h.removeAllRanges()}}catch{}}function w(s,h){s.classList?s.classList.add(h):s.className.match(new RegExp("(?:^|\\s)".concat(h,"(?!\\S)")))||(s.className+=" ".concat(h))}function M(s,h){s.classList?s.classList.remove(h):s.className=s.className.replace(new RegExp("(?:^|\\s)".concat(h,"(?!\\S)"),"g"),"")}return O}var X={},St;function jt(){if(St)return X;St=1,Object.defineProperty(X,"__esModule",{value:!0}),X.canDragX=r,X.canDragY=o,X.createCoreData=l,X.createDraggableData=g,X.getBoundPosition=e,X.getControlPosition=a,X.snapToGrid=t;var i=ot(),n=ft();function e(f,m,x){if(!f.props.bounds)return[m,x];let{bounds:b}=f.props;b=typeof b=="string"?b:c(b);const D=S(f);if(typeof b=="string"){const{ownerDocument:y}=D,p=y.defaultView;let d;if(b==="parent"?d=D.parentNode:d=y.querySelector(b),!(d instanceof p.HTMLElement))throw new Error('Bounds selector "'+b+'" could not find an element.');const u=d,v=p.getComputedStyle(D),w=p.getComputedStyle(u);b={left:-D.offsetLeft+(0,i.int)(w.paddingLeft)+(0,i.int)(v.marginLeft),top:-D.offsetTop+(0,i.int)(w.paddingTop)+(0,i.int)(v.marginTop),right:(0,n.innerWidth)(u)-(0,n.outerWidth)(D)-D.offsetLeft+(0,i.int)(w.paddingRight)-(0,i.int)(v.marginRight),bottom:(0,n.innerHeight)(u)-(0,n.outerHeight)(D)-D.offsetTop+(0,i.int)(w.paddingBottom)-(0,i.int)(v.marginBottom)}}return(0,i.isNum)(b.right)&&(m=Math.min(m,b.right)),(0,i.isNum)(b.bottom)&&(x=Math.min(x,b.bottom)),(0,i.isNum)(b.left)&&(m=Math.max(m,b.left)),(0,i.isNum)(b.top)&&(x=Math.max(x,b.top)),[m,x]}function t(f,m,x){const b=Math.round(m/f[0])*f[0],D=Math.round(x/f[1])*f[1];return[b,D]}function r(f){return f.props.axis==="both"||f.props.axis==="x"}function o(f){return f.props.axis==="both"||f.props.axis==="y"}function a(f,m,x){const b=typeof m=="number"?(0,n.getTouch)(f,m):null;if(typeof m=="number"&&!b)return null;const D=S(x),y=x.props.offsetParent||D.offsetParent||D.ownerDocument.body;return(0,n.offsetXYFromParent)(b||f,y,x.props.scale)}function l(f,m,x){const b=!(0,i.isNum)(f.lastX),D=S(f);return b?{node:D,deltaX:0,deltaY:0,lastX:m,lastY:x,x:m,y:x}:{node:D,deltaX:m-f.lastX,deltaY:x-f.lastY,lastX:f.lastX,lastY:f.lastY,x:m,y:x}}function g(f,m){const x=f.props.scale;return{node:m.node,x:f.state.x+m.deltaX/x,y:f.state.y+m.deltaY/x,deltaX:m.deltaX/x,deltaY:m.deltaY/x,lastX:f.state.x,lastY:f.state.y}}function c(f){return{left:f.left,top:f.top,right:f.right,bottom:f.bottom}}function S(f){const m=f.findDOMNode();if(!m)throw new Error("<DraggableCore>: Unmounted during event!");return m}return X}var tt={},et={},zt;function At(){if(zt)return et;zt=1,Object.defineProperty(et,"__esModule",{value:!0}),et.default=i;function i(){}return et}var Dt;function te(){if(Dt)return tt;Dt=1,Object.defineProperty(tt,"__esModule",{value:!0}),tt.default=void 0;var i=c(Wt()),n=l(Ht()),e=l(Tt()),t=ft(),r=jt(),o=ot(),a=l(At());function l(y){return y&&y.__esModule?y:{default:y}}function g(y){if(typeof WeakMap!="function")return null;var p=new WeakMap,d=new WeakMap;return(g=function(u){return u?d:p})(y)}function c(y,p){if(y&&y.__esModule)return y;if(y===null||typeof y!="object"&&typeof y!="function")return{default:y};var d=g(p);if(d&&d.has(y))return d.get(y);var u={},v=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in y)if(w!=="default"&&Object.prototype.hasOwnProperty.call(y,w)){var M=v?Object.getOwnPropertyDescriptor(y,w):null;M&&(M.get||M.set)?Object.defineProperty(u,w,M):u[w]=y[w]}return u.default=y,d&&d.set(y,u),u}function S(y,p,d){return p=f(p),p in y?Object.defineProperty(y,p,{value:d,enumerable:!0,configurable:!0,writable:!0}):y[p]=d,y}function f(y){var p=m(y,"string");return typeof p=="symbol"?p:String(p)}function m(y,p){if(typeof y!="object"||y===null)return y;var d=y[Symbol.toPrimitive];if(d!==void 0){var u=d.call(y,p);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(p==="string"?String:Number)(y)}const x={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let b=x.mouse,D=class extends i.Component{constructor(){super(...arguments),S(this,"dragging",!1),S(this,"lastX",NaN),S(this,"lastY",NaN),S(this,"touchIdentifier",null),S(this,"mounted",!1),S(this,"handleDragStart",p=>{if(this.props.onMouseDown(p),!this.props.allowAnyClick&&typeof p.button=="number"&&p.button!==0)return!1;const d=this.findDOMNode();if(!d||!d.ownerDocument||!d.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:u}=d;if(this.props.disabled||!(p.target instanceof u.defaultView.Node)||this.props.handle&&!(0,t.matchesSelectorAndParentsTo)(p.target,this.props.handle,d)||this.props.cancel&&(0,t.matchesSelectorAndParentsTo)(p.target,this.props.cancel,d))return;p.type==="touchstart"&&p.preventDefault();const v=(0,t.getTouchIdentifier)(p);this.touchIdentifier=v;const w=(0,r.getControlPosition)(p,v,this);if(w==null)return;const{x:M,y:s}=w,h=(0,r.createCoreData)(this,M,s);(0,a.default)("DraggableCore: handleDragStart: %j",h),(0,a.default)("calling",this.props.onStart),!(this.props.onStart(p,h)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,t.addUserSelectStyles)(u),this.dragging=!0,this.lastX=M,this.lastY=s,(0,t.addEvent)(u,b.move,this.handleDrag),(0,t.addEvent)(u,b.stop,this.handleDragStop))}),S(this,"handleDrag",p=>{const d=(0,r.getControlPosition)(p,this.touchIdentifier,this);if(d==null)return;let{x:u,y:v}=d;if(Array.isArray(this.props.grid)){let s=u-this.lastX,h=v-this.lastY;if([s,h]=(0,r.snapToGrid)(this.props.grid,s,h),!s&&!h)return;u=this.lastX+s,v=this.lastY+h}const w=(0,r.createCoreData)(this,u,v);if((0,a.default)("DraggableCore: handleDrag: %j",w),this.props.onDrag(p,w)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch{const h=document.createEvent("MouseEvents");h.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(h)}return}this.lastX=u,this.lastY=v}),S(this,"handleDragStop",p=>{if(!this.dragging)return;const d=(0,r.getControlPosition)(p,this.touchIdentifier,this);if(d==null)return;let{x:u,y:v}=d;if(Array.isArray(this.props.grid)){let h=u-this.lastX||0,z=v-this.lastY||0;[h,z]=(0,r.snapToGrid)(this.props.grid,h,z),u=this.lastX+h,v=this.lastY+z}const w=(0,r.createCoreData)(this,u,v);if(this.props.onStop(p,w)===!1||this.mounted===!1)return!1;const s=this.findDOMNode();s&&this.props.enableUserSelectHack&&(0,t.removeUserSelectStyles)(s.ownerDocument),(0,a.default)("DraggableCore: handleDragStop: %j",w),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,s&&((0,a.default)("DraggableCore: Removing handlers"),(0,t.removeEvent)(s.ownerDocument,b.move,this.handleDrag),(0,t.removeEvent)(s.ownerDocument,b.stop,this.handleDragStop))}),S(this,"onMouseDown",p=>(b=x.mouse,this.handleDragStart(p))),S(this,"onMouseUp",p=>(b=x.mouse,this.handleDragStop(p))),S(this,"onTouchStart",p=>(b=x.touch,this.handleDragStart(p))),S(this,"onTouchEnd",p=>(b=x.touch,this.handleDragStop(p)))}componentDidMount(){this.mounted=!0;const p=this.findDOMNode();p&&(0,t.addEvent)(p,x.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const p=this.findDOMNode();if(p){const{ownerDocument:d}=p;(0,t.removeEvent)(d,x.mouse.move,this.handleDrag),(0,t.removeEvent)(d,x.touch.move,this.handleDrag),(0,t.removeEvent)(d,x.mouse.stop,this.handleDragStop),(0,t.removeEvent)(d,x.touch.stop,this.handleDragStop),(0,t.removeEvent)(p,x.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,t.removeUserSelectStyles)(d)}}findDOMNode(){var p,d;return(p=this.props)!==null&&p!==void 0&&p.nodeRef?(d=this.props)===null||d===void 0||(d=d.nodeRef)===null||d===void 0?void 0:d.current:e.default.findDOMNode(this)}render(){return i.cloneElement(i.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};return tt.default=D,S(D,"displayName","DraggableCore"),S(D,"propTypes",{allowAnyClick:n.default.bool,children:n.default.node.isRequired,disabled:n.default.bool,enableUserSelectHack:n.default.bool,offsetParent:function(y,p){if(y[p]&&y[p].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:n.default.arrayOf(n.default.number),handle:n.default.string,cancel:n.default.string,nodeRef:n.default.object,onStart:n.default.func,onDrag:n.default.func,onStop:n.default.func,onMouseDown:n.default.func,scale:n.default.number,className:o.dontSetMe,style:o.dontSetMe,transform:o.dontSetMe}),S(D,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1}),tt}var Rt;function ee(){return Rt||(Rt=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(i,"DraggableCore",{enumerable:!0,get:function(){return g.default}}),i.default=void 0;var n=m(Wt()),e=S(Ht()),t=S(Tt()),r=S(Jt),o=ft(),a=jt(),l=ot(),g=S(te()),c=S(At());function S(d){return d&&d.__esModule?d:{default:d}}function f(d){if(typeof WeakMap!="function")return null;var u=new WeakMap,v=new WeakMap;return(f=function(w){return w?v:u})(d)}function m(d,u){if(d&&d.__esModule)return d;if(d===null||typeof d!="object"&&typeof d!="function")return{default:d};var v=f(u);if(v&&v.has(d))return v.get(d);var w={},M=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in d)if(s!=="default"&&Object.prototype.hasOwnProperty.call(d,s)){var h=M?Object.getOwnPropertyDescriptor(d,s):null;h&&(h.get||h.set)?Object.defineProperty(w,s,h):w[s]=d[s]}return w.default=d,v&&v.set(d,w),w}function x(){return x=Object.assign?Object.assign.bind():function(d){for(var u=1;u<arguments.length;u++){var v=arguments[u];for(var w in v)Object.prototype.hasOwnProperty.call(v,w)&&(d[w]=v[w])}return d},x.apply(this,arguments)}function b(d,u,v){return u=D(u),u in d?Object.defineProperty(d,u,{value:v,enumerable:!0,configurable:!0,writable:!0}):d[u]=v,d}function D(d){var u=y(d,"string");return typeof u=="symbol"?u:String(u)}function y(d,u){if(typeof d!="object"||d===null)return d;var v=d[Symbol.toPrimitive];if(v!==void 0){var w=v.call(d,u);if(typeof w!="object")return w;throw new TypeError("@@toPrimitive must return a primitive value.")}return(u==="string"?String:Number)(d)}class p extends n.Component{static getDerivedStateFromProps(u,v){let{position:w}=u,{prevPropsPosition:M}=v;return w&&(!M||w.x!==M.x||w.y!==M.y)?((0,c.default)("Draggable: getDerivedStateFromProps %j",{position:w,prevPropsPosition:M}),{x:w.x,y:w.y,prevPropsPosition:{...w}}):null}constructor(u){super(u),b(this,"onDragStart",(v,w)=>{if((0,c.default)("Draggable: onDragStart: %j",w),this.props.onStart(v,(0,a.createDraggableData)(this,w))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),b(this,"onDrag",(v,w)=>{if(!this.state.dragging)return!1;(0,c.default)("Draggable: onDrag: %j",w);const M=(0,a.createDraggableData)(this,w),s={x:M.x,y:M.y,slackX:0,slackY:0};if(this.props.bounds){const{x:z,y:_}=s;s.x+=this.state.slackX,s.y+=this.state.slackY;const[C,N]=(0,a.getBoundPosition)(this,s.x,s.y);s.x=C,s.y=N,s.slackX=this.state.slackX+(z-s.x),s.slackY=this.state.slackY+(_-s.y),M.x=s.x,M.y=s.y,M.deltaX=s.x-this.state.x,M.deltaY=s.y-this.state.y}if(this.props.onDrag(v,M)===!1)return!1;this.setState(s)}),b(this,"onDragStop",(v,w)=>{if(!this.state.dragging||this.props.onStop(v,(0,a.createDraggableData)(this,w))===!1)return!1;(0,c.default)("Draggable: onDragStop: %j",w);const s={dragging:!1,slackX:0,slackY:0};if(!!this.props.position){const{x:z,y:_}=this.props.position;s.x=z,s.y=_}this.setState(s)}),this.state={dragging:!1,dragged:!1,x:u.position?u.position.x:u.defaultPosition.x,y:u.position?u.position.y:u.defaultPosition.y,prevPropsPosition:{...u.position},slackX:0,slackY:0,isElementSVG:!1},u.position&&!(u.onDrag||u.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){typeof window.SVGElement<"u"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.setState({dragging:!1})}findDOMNode(){var u,v;return(u=(v=this.props)===null||v===void 0||(v=v.nodeRef)===null||v===void 0?void 0:v.current)!==null&&u!==void 0?u:t.default.findDOMNode(this)}render(){const{axis:u,bounds:v,children:w,defaultPosition:M,defaultClassName:s,defaultClassNameDragging:h,defaultClassNameDragged:z,position:_,positionOffset:C,scale:N,...T}=this.props;let L={},F=null;const I=!!!_||this.state.dragging,U=_||M,q={x:(0,a.canDragX)(this)&&I?this.state.x:U.x,y:(0,a.canDragY)(this)&&I?this.state.y:U.y};this.state.isElementSVG?F=(0,o.createSVGTransform)(q,C):L=(0,o.createCSSTransform)(q,C);const P=(0,r.default)(w.props.className||"",s,{[h]:this.state.dragging,[z]:this.state.dragged});return n.createElement(g.default,x({},T,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),n.cloneElement(n.Children.only(w),{className:P,style:{...w.props.style,...L},transform:F}))}}i.default=p,b(p,"displayName","Draggable"),b(p,"propTypes",{...g.default.propTypes,axis:e.default.oneOf(["both","x","y","none"]),bounds:e.default.oneOfType([e.default.shape({left:e.default.number,right:e.default.number,top:e.default.number,bottom:e.default.number}),e.default.string,e.default.oneOf([!1])]),defaultClassName:e.default.string,defaultClassNameDragging:e.default.string,defaultClassNameDragged:e.default.string,defaultPosition:e.default.shape({x:e.default.number,y:e.default.number}),positionOffset:e.default.shape({x:e.default.oneOfType([e.default.number,e.default.string]),y:e.default.oneOfType([e.default.number,e.default.string])}),position:e.default.shape({x:e.default.number,y:e.default.number}),className:l.dontSetMe,style:l.dontSetMe,transform:l.dontSetMe}),b(p,"defaultProps",{...g.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})}(lt)),lt}var Pt;function ie(){if(Pt)return Q.exports;Pt=1;const{default:i,DraggableCore:n}=ee();return Q.exports=i,Q.exports.default=i,Q.exports.DraggableCore=n,Q.exports}var re=ie();const se=Bt(re);var H=function(){return H=Object.assign||function(i){for(var n,e=1,t=arguments.length;e<t;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},H.apply(this,arguments)},Mt={width:"100%",height:"10px",top:"0px",left:"0px",cursor:"row-resize"},_t={width:"10px",height:"100%",top:"0px",left:"0px",cursor:"col-resize"},it={width:"20px",height:"20px",position:"absolute",zIndex:1},ne={top:H(H({},Mt),{top:"-5px"}),right:H(H({},_t),{left:void 0,right:"-5px"}),bottom:H(H({},Mt),{top:void 0,bottom:"-5px"}),left:H(H({},_t),{left:"-5px"}),topRight:H(H({},it),{right:"-10px",top:"-10px",cursor:"ne-resize"}),bottomRight:H(H({},it),{right:"-10px",bottom:"-10px",cursor:"se-resize"}),bottomLeft:H(H({},it),{left:"-10px",bottom:"-10px",cursor:"sw-resize"}),topLeft:H(H({},it),{left:"-10px",top:"-10px",cursor:"nw-resize"})},oe=W.memo(function(i){var n=i.onResizeStart,e=i.direction,t=i.children,r=i.replaceStyles,o=i.className,a=W.useCallback(function(c){n(c,e)},[n,e]),l=W.useCallback(function(c){n(c,e)},[n,e]),g=W.useMemo(function(){return H(H({position:"absolute",userSelect:"none"},ne[e]),r??{})},[r,e]);return R.jsx("div",{className:o||void 0,style:g,onMouseDown:a,onTouchStart:l,children:t})}),ae=function(){var i=function(n,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},i(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}(),Y=function(){return Y=Object.assign||function(i){for(var n,e=1,t=arguments.length;e<t;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},Y.apply(this,arguments)},le={width:"auto",height:"auto"},rt=function(i,n,e){return Math.max(Math.min(i,e),n)},Nt=function(i,n,e){var t=Math.round(i/n);return t*n+e*(t-1)},J=function(i,n){return new RegExp(i,"i").test(n)},st=function(i){return!!(i.touches&&i.touches.length)},he=function(i){return!!((i.clientX||i.clientX===0)&&(i.clientY||i.clientY===0))},Ct=function(i,n,e){e===void 0&&(e=0);var t=n.reduce(function(o,a,l){return Math.abs(a-i)<Math.abs(n[o]-i)?l:o},0),r=Math.abs(n[t]-i);return e===0||r<e?n[t]:i},ct=function(i){return i=i.toString(),i==="auto"||i.endsWith("px")||i.endsWith("%")||i.endsWith("vh")||i.endsWith("vw")||i.endsWith("vmax")||i.endsWith("vmin")?i:"".concat(i,"px")},nt=function(i,n,e,t){if(i&&typeof i=="string"){if(i.endsWith("px"))return Number(i.replace("px",""));if(i.endsWith("%")){var r=Number(i.replace("%",""))/100;return n*r}if(i.endsWith("vw")){var r=Number(i.replace("vw",""))/100;return e*r}if(i.endsWith("vh")){var r=Number(i.replace("vh",""))/100;return t*r}}return i},de=function(i,n,e,t,r,o,a){return t=nt(t,i.width,n,e),r=nt(r,i.height,n,e),o=nt(o,i.width,n,e),a=nt(a,i.height,n,e),{maxWidth:typeof t>"u"?void 0:Number(t),maxHeight:typeof r>"u"?void 0:Number(r),minWidth:typeof o>"u"?void 0:Number(o),minHeight:typeof a>"u"?void 0:Number(a)}},ue=function(i){return Array.isArray(i)?i:[i,i]},ce=["as","ref","style","className","grid","gridGap","snap","bounds","boundsByDirection","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],Et="__resizable_base__",pe=function(i){ae(n,i);function n(e){var t,r,o,a,l=i.call(this,e)||this;return l.ratio=1,l.resizable=null,l.parentLeft=0,l.parentTop=0,l.resizableLeft=0,l.resizableRight=0,l.resizableTop=0,l.resizableBottom=0,l.targetLeft=0,l.targetTop=0,l.delta={width:0,height:0},l.appendBase=function(){if(!l.resizable||!l.window)return null;var g=l.parentNode;if(!g)return null;var c=l.window.document.createElement("div");return c.style.width="100%",c.style.height="100%",c.style.position="absolute",c.style.transform="scale(0, 0)",c.style.left="0",c.style.flex="0 0 100%",c.classList?c.classList.add(Et):c.className+=Et,g.appendChild(c),c},l.removeBase=function(g){var c=l.parentNode;c&&c.removeChild(g)},l.state={isResizing:!1,width:(r=(t=l.propsSize)===null||t===void 0?void 0:t.width)!==null&&r!==void 0?r:"auto",height:(a=(o=l.propsSize)===null||o===void 0?void 0:o.height)!==null&&a!==void 0?a:"auto",direction:"right",original:{x:0,y:0,width:0,height:0},backgroundStyle:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:"auto",opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"},flexBasis:void 0},l.onResizeStart=l.onResizeStart.bind(l),l.onMouseMove=l.onMouseMove.bind(l),l.onMouseUp=l.onMouseUp.bind(l),l}return Object.defineProperty(n.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"window",{get:function(){return!this.resizable||!this.resizable.ownerDocument?null:this.resizable.ownerDocument.defaultView},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||le},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"size",{get:function(){var e=0,t=0;if(this.resizable&&this.window){var r=this.resizable.offsetWidth,o=this.resizable.offsetHeight,a=this.resizable.style.position;a!=="relative"&&(this.resizable.style.position="relative"),e=this.resizable.style.width!=="auto"?this.resizable.offsetWidth:r,t=this.resizable.style.height!=="auto"?this.resizable.offsetHeight:o,this.resizable.style.position=a}return{width:e,height:t}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"sizeStyle",{get:function(){var e=this,t=this.props.size,r=function(l){var g;if(typeof e.state[l]>"u"||e.state[l]==="auto")return"auto";if(e.propsSize&&e.propsSize[l]&&(!((g=e.propsSize[l])===null||g===void 0)&&g.toString().endsWith("%"))){if(e.state[l].toString().endsWith("%"))return e.state[l].toString();var c=e.getParentSize(),S=Number(e.state[l].toString().replace("px","")),f=S/c[l]*100;return"".concat(f,"%")}return ct(e.state[l])},o=t&&typeof t.width<"u"&&!this.state.isResizing?ct(t.width):r("width"),a=t&&typeof t.height<"u"&&!this.state.isResizing?ct(t.height):r("height");return{width:o,height:a}},enumerable:!1,configurable:!0}),n.prototype.getParentSize=function(){if(!this.parentNode)return this.window?{width:this.window.innerWidth,height:this.window.innerHeight}:{width:0,height:0};var e=this.appendBase();if(!e)return{width:0,height:0};var t=!1,r=this.parentNode.style.flexWrap;r!=="wrap"&&(t=!0,this.parentNode.style.flexWrap="wrap"),e.style.position="relative",e.style.minWidth="100%",e.style.minHeight="100%";var o={width:e.offsetWidth,height:e.offsetHeight};return t&&(this.parentNode.style.flexWrap=r),this.removeBase(e),o},n.prototype.bindEvents=function(){this.window&&(this.window.addEventListener("mouseup",this.onMouseUp),this.window.addEventListener("mousemove",this.onMouseMove),this.window.addEventListener("mouseleave",this.onMouseUp),this.window.addEventListener("touchmove",this.onMouseMove,{capture:!0,passive:!1}),this.window.addEventListener("touchend",this.onMouseUp))},n.prototype.unbindEvents=function(){this.window&&(this.window.removeEventListener("mouseup",this.onMouseUp),this.window.removeEventListener("mousemove",this.onMouseMove),this.window.removeEventListener("mouseleave",this.onMouseUp),this.window.removeEventListener("touchmove",this.onMouseMove,!0),this.window.removeEventListener("touchend",this.onMouseUp))},n.prototype.componentDidMount=function(){if(!(!this.resizable||!this.window)){var e=this.window.getComputedStyle(this.resizable);this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height,flexBasis:e.flexBasis!=="auto"?e.flexBasis:void 0})}},n.prototype.componentWillUnmount=function(){this.window&&this.unbindEvents()},n.prototype.createSizeForCssProperty=function(e,t){var r=this.propsSize&&this.propsSize[t];return this.state[t]==="auto"&&this.state.original[t]===e&&(typeof r>"u"||r==="auto")?"auto":e},n.prototype.calculateNewMaxFromBoundary=function(e,t){var r=this.props.boundsByDirection,o=this.state.direction,a=r&&J("left",o),l=r&&J("top",o),g,c;if(this.props.bounds==="parent"){var S=this.parentNode;S&&(g=a?this.resizableRight-this.parentLeft:S.offsetWidth+(this.parentLeft-this.resizableLeft),c=l?this.resizableBottom-this.parentTop:S.offsetHeight+(this.parentTop-this.resizableTop))}else this.props.bounds==="window"?this.window&&(g=a?this.resizableRight:this.window.innerWidth-this.resizableLeft,c=l?this.resizableBottom:this.window.innerHeight-this.resizableTop):this.props.bounds&&(g=a?this.resizableRight-this.targetLeft:this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),c=l?this.resizableBottom-this.targetTop:this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop));return g&&Number.isFinite(g)&&(e=e&&e<g?e:g),c&&Number.isFinite(c)&&(t=t&&t<c?t:c),{maxWidth:e,maxHeight:t}},n.prototype.calculateNewSizeFromDirection=function(e,t){var r=this.props.scale||1,o=ue(this.props.resizeRatio||1),a=o[0],l=o[1],g=this.state,c=g.direction,S=g.original,f=this.props,m=f.lockAspectRatio,x=f.lockAspectRatioExtraHeight,b=f.lockAspectRatioExtraWidth,D=S.width,y=S.height,p=x||0,d=b||0;return J("right",c)&&(D=S.width+(e-S.x)*a/r,m&&(y=(D-d)/this.ratio+p)),J("left",c)&&(D=S.width-(e-S.x)*a/r,m&&(y=(D-d)/this.ratio+p)),J("bottom",c)&&(y=S.height+(t-S.y)*l/r,m&&(D=(y-p)*this.ratio+d)),J("top",c)&&(y=S.height-(t-S.y)*l/r,m&&(D=(y-p)*this.ratio+d)),{newWidth:D,newHeight:y}},n.prototype.calculateNewSizeFromAspectRatio=function(e,t,r,o){var a=this.props,l=a.lockAspectRatio,g=a.lockAspectRatioExtraHeight,c=a.lockAspectRatioExtraWidth,S=typeof o.width>"u"?10:o.width,f=typeof r.width>"u"||r.width<0?e:r.width,m=typeof o.height>"u"?10:o.height,x=typeof r.height>"u"||r.height<0?t:r.height,b=g||0,D=c||0;if(l){var y=(m-b)*this.ratio+D,p=(x-b)*this.ratio+D,d=(S-D)/this.ratio+b,u=(f-D)/this.ratio+b,v=Math.max(S,y),w=Math.min(f,p),M=Math.max(m,d),s=Math.min(x,u);e=rt(e,v,w),t=rt(t,M,s)}else e=rt(e,S,f),t=rt(t,m,x);return{newWidth:e,newHeight:t}},n.prototype.setBoundingClientRect=function(){var e=1/(this.props.scale||1);if(this.props.bounds==="parent"){var t=this.parentNode;if(t){var r=t.getBoundingClientRect();this.parentLeft=r.left*e,this.parentTop=r.top*e}}if(this.props.bounds&&typeof this.props.bounds!="string"){var o=this.props.bounds.getBoundingClientRect();this.targetLeft=o.left*e,this.targetTop=o.top*e}if(this.resizable){var a=this.resizable.getBoundingClientRect(),l=a.left,g=a.top,c=a.right,S=a.bottom;this.resizableLeft=l*e,this.resizableRight=c*e,this.resizableTop=g*e,this.resizableBottom=S*e}},n.prototype.onResizeStart=function(e,t){if(!(!this.resizable||!this.window)){var r=0,o=0;if(e.nativeEvent&&he(e.nativeEvent)?(r=e.nativeEvent.clientX,o=e.nativeEvent.clientY):e.nativeEvent&&st(e.nativeEvent)&&(r=e.nativeEvent.touches[0].clientX,o=e.nativeEvent.touches[0].clientY),this.props.onResizeStart&&this.resizable){var a=this.props.onResizeStart(e,t,this.resizable);if(a===!1)return}this.props.size&&(typeof this.props.size.height<"u"&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),typeof this.props.size.width<"u"&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio=typeof this.props.lockAspectRatio=="number"?this.props.lockAspectRatio:this.size.width/this.size.height;var l,g=this.window.getComputedStyle(this.resizable);if(g.flexBasis!=="auto"){var c=this.parentNode;if(c){var S=this.window.getComputedStyle(c).flexDirection;this.flexDir=S.startsWith("row")?"row":"column",l=g.flexBasis}}this.setBoundingClientRect(),this.bindEvents();var f={original:{x:r,y:o,width:this.size.width,height:this.size.height},isResizing:!0,backgroundStyle:Y(Y({},this.state.backgroundStyle),{cursor:this.window.getComputedStyle(e.target).cursor||"auto"}),direction:t,flexBasis:l};this.setState(f)}},n.prototype.onMouseMove=function(e){var t=this;if(!(!this.state.isResizing||!this.resizable||!this.window)){if(this.window.TouchEvent&&st(e))try{e.preventDefault(),e.stopPropagation()}catch{}var r=this.props,o=r.maxWidth,a=r.maxHeight,l=r.minWidth,g=r.minHeight,c=st(e)?e.touches[0].clientX:e.clientX,S=st(e)?e.touches[0].clientY:e.clientY,f=this.state,m=f.direction,x=f.original,b=f.width,D=f.height,y=this.getParentSize(),p=de(y,this.window.innerWidth,this.window.innerHeight,o,a,l,g);o=p.maxWidth,a=p.maxHeight,l=p.minWidth,g=p.minHeight;var d=this.calculateNewSizeFromDirection(c,S),u=d.newHeight,v=d.newWidth,w=this.calculateNewMaxFromBoundary(o,a);this.props.snap&&this.props.snap.x&&(v=Ct(v,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(u=Ct(u,this.props.snap.y,this.props.snapGap));var M=this.calculateNewSizeFromAspectRatio(v,u,{width:w.maxWidth,height:w.maxHeight},{width:l,height:g});if(v=M.newWidth,u=M.newHeight,this.props.grid){var s=Nt(v,this.props.grid[0],this.props.gridGap?this.props.gridGap[0]:0),h=Nt(u,this.props.grid[1],this.props.gridGap?this.props.gridGap[1]:0),z=this.props.snapGap||0,_=z===0||Math.abs(s-v)<=z?s:v,C=z===0||Math.abs(h-u)<=z?h:u;v=_,u=C}var N={width:v-x.width,height:u-x.height};if(this.delta=N,b&&typeof b=="string"){if(b.endsWith("%")){var T=v/y.width*100;v="".concat(T,"%")}else if(b.endsWith("vw")){var L=v/this.window.innerWidth*100;v="".concat(L,"vw")}else if(b.endsWith("vh")){var F=v/this.window.innerHeight*100;v="".concat(F,"vh")}}if(D&&typeof D=="string"){if(D.endsWith("%")){var T=u/y.height*100;u="".concat(T,"%")}else if(D.endsWith("vw")){var L=u/this.window.innerWidth*100;u="".concat(L,"vw")}else if(D.endsWith("vh")){var F=u/this.window.innerHeight*100;u="".concat(F,"vh")}}var B={width:this.createSizeForCssProperty(v,"width"),height:this.createSizeForCssProperty(u,"height")};this.flexDir==="row"?B.flexBasis=B.width:this.flexDir==="column"&&(B.flexBasis=B.height);var I=this.state.width!==B.width,U=this.state.height!==B.height,q=this.state.flexBasis!==B.flexBasis,P=I||U||q;P&&Ot.flushSync(function(){t.setState(B)}),this.props.onResize&&P&&this.props.onResize(e,m,this.resizable,N)}},n.prototype.onMouseUp=function(e){var t,r,o=this.state,a=o.isResizing,l=o.direction;o.original,!(!a||!this.resizable)&&(this.props.onResizeStop&&this.props.onResizeStop(e,l,this.resizable,this.delta),this.props.size&&this.setState({width:(t=this.props.size.width)!==null&&t!==void 0?t:"auto",height:(r=this.props.size.height)!==null&&r!==void 0?r:"auto"}),this.unbindEvents(),this.setState({isResizing:!1,backgroundStyle:Y(Y({},this.state.backgroundStyle),{cursor:"auto"})}))},n.prototype.updateSize=function(e){var t,r;this.setState({width:(t=e.width)!==null&&t!==void 0?t:"auto",height:(r=e.height)!==null&&r!==void 0?r:"auto"})},n.prototype.renderResizer=function(){var e=this,t=this.props,r=t.enable,o=t.handleStyles,a=t.handleClasses,l=t.handleWrapperStyle,g=t.handleWrapperClass,c=t.handleComponent;if(!r)return null;var S=Object.keys(r).map(function(f){return r[f]!==!1?R.jsx(oe,{direction:f,onResizeStart:e.onResizeStart,replaceStyles:o&&o[f],className:a&&a[f],children:c&&c[f]?c[f]:null},f):null});return R.jsx("div",{className:g,style:l,children:S})},n.prototype.render=function(){var e=this,t=Object.keys(this.props).reduce(function(a,l){return ce.indexOf(l)!==-1||(a[l]=e.props[l]),a},{}),r=Y(Y(Y({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style),this.sizeStyle),{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0});this.state.flexBasis&&(r.flexBasis=this.state.flexBasis);var o=this.props.as||"div";return R.jsxs(o,Y({style:r,className:this.props.className},t,{ref:function(a){a&&(e.resizable=a)},children:[this.state.isResizing&&R.jsx("div",{style:this.state.backgroundStyle}),this.props.children,this.renderResizer()]}))},n.defaultProps={as:"div",onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],gridGap:[0,0],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},n}(W.PureComponent);/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var pt=function(i,n){return pt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},pt(i,n)};function fe(i,n){pt(i,n);function e(){this.constructor=i}i.prototype=n===null?Object.create(n):(e.prototype=n.prototype,new e)}var j=function(){return j=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o])}return n},j.apply(this,arguments)};function ge(i,n){var e={};for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&n.indexOf(t)<0&&(e[t]=i[t]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,t=Object.getOwnPropertySymbols(i);r<t.length;r++)n.indexOf(t[r])<0&&Object.prototype.propertyIsEnumerable.call(i,t[r])&&(e[t[r]]=i[t[r]]);return e}var me={width:"auto",height:"auto",display:"inline-block",position:"absolute",top:0,left:0},ve=function(i){return{bottom:i,bottomLeft:i,bottomRight:i,left:i,right:i,top:i,topLeft:i,topRight:i}},ye=function(i){fe(n,i);function n(e){var t=i.call(this,e)||this;return t.resizingPosition={x:0,y:0},t.offsetFromParent={left:0,top:0},t.resizableElement={current:null},t.originalPosition={x:0,y:0},t.state={resizing:!1,bounds:{top:0,right:0,bottom:0,left:0},maxWidth:e.maxWidth,maxHeight:e.maxHeight},t.onResizeStart=t.onResizeStart.bind(t),t.onResize=t.onResize.bind(t),t.onResizeStop=t.onResizeStop.bind(t),t.onDragStart=t.onDragStart.bind(t),t.onDrag=t.onDrag.bind(t),t.onDragStop=t.onDragStop.bind(t),t.getMaxSizesFromProps=t.getMaxSizesFromProps.bind(t),t}return n.prototype.componentDidMount=function(){this.updateOffsetFromParent();var e=this.offsetFromParent,t=e.left,r=e.top,o=this.getDraggablePosition(),a=o.x,l=o.y;this.draggable.setState({x:a-t,y:l-r}),this.forceUpdate()},n.prototype.getDraggablePosition=function(){var e=this.draggable.state,t=e.x,r=e.y;return{x:t,y:r}},n.prototype.getParent=function(){return this.resizable&&this.resizable.parentNode},n.prototype.getParentSize=function(){return this.resizable.getParentSize()},n.prototype.getMaxSizesFromProps=function(){var e=typeof this.props.maxWidth>"u"?Number.MAX_SAFE_INTEGER:this.props.maxWidth,t=typeof this.props.maxHeight>"u"?Number.MAX_SAFE_INTEGER:this.props.maxHeight;return{maxWidth:e,maxHeight:t}},n.prototype.getSelfElement=function(){return this.resizable&&this.resizable.resizable},n.prototype.getOffsetHeight=function(e){var t=this.props.scale;switch(this.props.bounds){case"window":return window.innerHeight/t;case"body":return document.body.offsetHeight/t;default:return e.offsetHeight}},n.prototype.getOffsetWidth=function(e){var t=this.props.scale;switch(this.props.bounds){case"window":return window.innerWidth/t;case"body":return document.body.offsetWidth/t;default:return e.offsetWidth}},n.prototype.onDragStart=function(e,t){this.props.onDragStart&&this.props.onDragStart(e,t);var r=this.getDraggablePosition();if(this.originalPosition=r,!!this.props.bounds){var o=this.getParent(),a=this.props.scale,l;if(this.props.bounds==="parent")l=o;else if(this.props.bounds==="body"){var g=o.getBoundingClientRect(),c=g.left,S=g.top,f=document.body.getBoundingClientRect(),m=-(c-o.offsetLeft*a-f.left)/a,x=-(S-o.offsetTop*a-f.top)/a,b=(document.body.offsetWidth-this.resizable.size.width*a)/a+m,D=(document.body.offsetHeight-this.resizable.size.height*a)/a+x;return this.setState({bounds:{top:x,right:b,bottom:D,left:m}})}else if(this.props.bounds==="window"){if(!this.resizable)return;var y=o.getBoundingClientRect(),p=y.left,d=y.top,u=-(p-o.offsetLeft*a)/a,v=-(d-o.offsetTop*a)/a,b=(window.innerWidth-this.resizable.size.width*a)/a+u,D=(window.innerHeight-this.resizable.size.height*a)/a+v;return this.setState({bounds:{top:v,right:b,bottom:D,left:u}})}else typeof this.props.bounds=="string"?l=document.querySelector(this.props.bounds):this.props.bounds instanceof HTMLElement&&(l=this.props.bounds);if(!(!(l instanceof HTMLElement)||!(o instanceof HTMLElement))){var w=l.getBoundingClientRect(),M=w.left,s=w.top,h=o.getBoundingClientRect(),z=h.left,_=h.top,C=(M-z)/a,N=s-_;if(this.resizable){this.updateOffsetFromParent();var T=this.offsetFromParent;this.setState({bounds:{top:N-T.top,right:C+(l.offsetWidth-this.resizable.size.width)-T.left/a,bottom:N+(l.offsetHeight-this.resizable.size.height)-T.top,left:C-T.left/a}})}}}},n.prototype.onDrag=function(e,t){if(this.props.onDrag){var r=this.offsetFromParent,o=r.left,a=r.top;if(!this.props.dragAxis||this.props.dragAxis==="both")return this.props.onDrag(e,j(j({},t),{x:t.x+o,y:t.y+a}));if(this.props.dragAxis==="x")return this.props.onDrag(e,j(j({},t),{x:t.x+o,y:this.originalPosition.y+a,deltaY:0}));if(this.props.dragAxis==="y")return this.props.onDrag(e,j(j({},t),{x:this.originalPosition.x+o,y:t.y+a,deltaX:0}))}},n.prototype.onDragStop=function(e,t){if(this.props.onDragStop){var r=this.offsetFromParent,o=r.left,a=r.top;if(!this.props.dragAxis||this.props.dragAxis==="both")return this.props.onDragStop(e,j(j({},t),{x:t.x+o,y:t.y+a}));if(this.props.dragAxis==="x")return this.props.onDragStop(e,j(j({},t),{x:t.x+o,y:this.originalPosition.y+a,deltaY:0}));if(this.props.dragAxis==="y")return this.props.onDragStop(e,j(j({},t),{x:this.originalPosition.x+o,y:t.y+a,deltaX:0}))}},n.prototype.onResizeStart=function(e,t,r){e.stopPropagation(),this.setState({resizing:!0});var o=this.props.scale,a=this.offsetFromParent,l=this.getDraggablePosition();if(this.resizingPosition={x:l.x+a.left,y:l.y+a.top},this.originalPosition=l,this.props.bounds){var g=this.getParent(),c=void 0;this.props.bounds==="parent"?c=g:this.props.bounds==="body"?c=document.body:this.props.bounds==="window"?c=window:typeof this.props.bounds=="string"?c=document.querySelector(this.props.bounds):this.props.bounds instanceof HTMLElement&&(c=this.props.bounds);var S=this.getSelfElement();if(S instanceof Element&&(c instanceof HTMLElement||c===window)&&g instanceof HTMLElement){var f=this.getMaxSizesFromProps(),m=f.maxWidth,x=f.maxHeight,b=this.getParentSize();if(m&&typeof m=="string")if(m.endsWith("%")){var D=Number(m.replace("%",""))/100;m=b.width*D}else m.endsWith("px")&&(m=Number(m.replace("px","")));if(x&&typeof x=="string")if(x.endsWith("%")){var D=Number(x.replace("%",""))/100;x=b.height*D}else x.endsWith("px")&&(x=Number(x.replace("px","")));var y=S.getBoundingClientRect(),p=y.left,d=y.top,u=this.props.bounds==="window"?{left:0,top:0}:c.getBoundingClientRect(),v=u.left,w=u.top,M=this.getOffsetWidth(c),s=this.getOffsetHeight(c),h=t.toLowerCase().endsWith("left"),z=t.toLowerCase().endsWith("right"),_=t.startsWith("top"),C=t.startsWith("bottom");if((h||_)&&this.resizable){var N=(p-v)/o+this.resizable.size.width;this.setState({maxWidth:N>Number(m)?m:N})}if(z||this.props.lockAspectRatio&&!h&&!_){var N=M+(v-p)/o;this.setState({maxWidth:N>Number(m)?m:N})}if((_||h)&&this.resizable){var N=(d-w)/o+this.resizable.size.height;this.setState({maxHeight:N>Number(x)?x:N})}if(C||this.props.lockAspectRatio&&!_&&!h){var N=s+(w-d)/o;this.setState({maxHeight:N>Number(x)?x:N})}}}else this.setState({maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight});this.props.onResizeStart&&this.props.onResizeStart(e,t,r)},n.prototype.onResize=function(e,t,r,o){var a=this,l={x:this.originalPosition.x,y:this.originalPosition.y},g=-o.width,c=-o.height,S=["top","left","topLeft","bottomLeft","topRight"];S.includes(t)&&(t==="bottomLeft"?l.x+=g:(t==="topRight"||(l.x+=g),l.y+=c));var f=this.draggable.state;(l.x!==f.x||l.y!==f.y)&&Ot.flushSync(function(){a.draggable.setState(l)}),this.updateOffsetFromParent();var m=this.offsetFromParent,x=this.getDraggablePosition().x+m.left,b=this.getDraggablePosition().y+m.top;this.resizingPosition={x,y:b},this.props.onResize&&this.props.onResize(e,t,r,o,{x,y:b})},n.prototype.onResizeStop=function(e,t,r,o){this.setState({resizing:!1});var a=this.getMaxSizesFromProps(),l=a.maxWidth,g=a.maxHeight;this.setState({maxWidth:l,maxHeight:g}),this.props.onResizeStop&&this.props.onResizeStop(e,t,r,o,this.resizingPosition)},n.prototype.updateSize=function(e){this.resizable&&this.resizable.updateSize({width:e.width,height:e.height})},n.prototype.updatePosition=function(e){this.draggable.setState(e)},n.prototype.updateOffsetFromParent=function(){var e=this.props.scale,t=this.getParent(),r=this.getSelfElement();if(!t||r===null)return{top:0,left:0};var o=t.getBoundingClientRect(),a=o.left,l=o.top,g=r.getBoundingClientRect(),c=this.getDraggablePosition(),S=t.scrollLeft,f=t.scrollTop;this.offsetFromParent={left:g.left-a+S-c.x*e,top:g.top-l+f-c.y*e}},n.prototype.render=function(){var e=this,t=this.props,r=t.disableDragging,o=t.style,a=t.dragHandleClassName,l=t.position,g=t.onMouseDown,c=t.onMouseUp,S=t.dragAxis,f=t.dragGrid,m=t.bounds,x=t.enableUserSelectHack,b=t.cancel,D=t.children;t.onResizeStart,t.onResize,t.onResizeStop,t.onDragStart,t.onDrag,t.onDragStop;var y=t.resizeHandleStyles,p=t.resizeHandleClasses,d=t.resizeHandleComponent,u=t.enableResizing,v=t.resizeGrid,w=t.resizeHandleWrapperClass,M=t.resizeHandleWrapperStyle,s=t.scale,h=t.allowAnyClick,z=t.dragPositionOffset,_=ge(t,["disableDragging","style","dragHandleClassName","position","onMouseDown","onMouseUp","dragAxis","dragGrid","bounds","enableUserSelectHack","cancel","children","onResizeStart","onResize","onResizeStop","onDragStart","onDrag","onDragStop","resizeHandleStyles","resizeHandleClasses","resizeHandleComponent","enableResizing","resizeGrid","resizeHandleWrapperClass","resizeHandleWrapperStyle","scale","allowAnyClick","dragPositionOffset"]),C=this.props.default?j({},this.props.default):void 0;delete _.default;var N=r||a?{cursor:"auto"}:{cursor:"move"},T=j(j(j({},me),N),o),L=this.offsetFromParent,F=L.left,B=L.top,I;l&&(I={x:l.x-F,y:l.y-B});var U=this.state.resizing?void 0:I,q=this.state.resizing?"both":S;return W.createElement(se,{ref:function(P){P&&(e.draggable=P)},handle:a?".".concat(a):void 0,defaultPosition:C,onMouseDown:g,onMouseUp:c,onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop,axis:q,disabled:r,grid:f,bounds:m?this.state.bounds:void 0,position:U,enableUserSelectHack:x,cancel:b,scale:s,allowAnyClick:h,nodeRef:this.resizableElement,positionOffset:z},W.createElement(pe,j({},_,{ref:function(P){P&&(e.resizable=P,e.resizableElement.current=P.resizable)},defaultSize:C,size:this.props.size,enable:typeof u=="boolean"?ve(u):u,onResizeStart:this.onResizeStart,onResize:this.onResize,onResizeStop:this.onResizeStop,style:T,minWidth:this.props.minWidth,minHeight:this.props.minHeight,maxWidth:this.state.resizing?this.state.maxWidth:this.props.maxWidth,maxHeight:this.state.resizing?this.state.maxHeight:this.props.maxHeight,grid:v,handleWrapperClass:w,handleWrapperStyle:M,lockAspectRatio:this.props.lockAspectRatio,lockAspectRatioExtraWidth:this.props.lockAspectRatioExtraWidth,lockAspectRatioExtraHeight:this.props.lockAspectRatioExtraHeight,handleStyles:y,handleClasses:p,handleComponent:d,scale:this.props.scale}),D))},n.defaultProps={maxWidth:Number.MAX_SAFE_INTEGER,maxHeight:Number.MAX_SAFE_INTEGER,scale:1,onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},onDragStart:function(){},onDrag:function(){},onDragStop:function(){}},n}(W.PureComponent);const _e=({otherUser:i,currentUser:n,onClose:e,isVisible:t,onlineUserIds:r})=>{const[o,a]=W.useState([]),[l,g]=W.useState(!1),[c,S]=W.useState(!1),[f,m]=W.useState(!1),[x,b]=W.useState(!1),[D,y]=W.useState(window.innerWidth-350-200),[p,d]=W.useState(window.innerHeight-500-125),[u,v]=W.useState(!0),[w,M]=W.useState(1),s=W.useRef(null),h=W.useRef(null),z=W.useRef(t),_=W.useRef(c);W.useEffect(()=>{z.current=t,_.current=c},[t,c]),W.useEffect(()=>{t&&(C(),T())},[t,i._id]),W.useEffect(()=>{const P=A=>{(A.sender._id===i._id&&A.recipient._id===n._id||A.sender._id===n._id&&A.recipient._id===i._id)&&(a(V=>[...V,A]),A.sender._id===i._id&&z.current&&!_.current&&T())},E=({senderId:A,readAt:V})=>{A===i._id&&a(at=>at.map(G=>G.sender._id===A&&!G.readAt?{...G,readAt:V}:G))},k=({readerId:A,readAt:V})=>{A===i._id&&a(at=>at.map(G=>G.sender._id===n._id&&!G.readAt?{...G,readAt:V}:G))};return $.on("newDirectMessage",P),$.on("directMessagesRead",E),$.on("allDirectMessagesRead",k),()=>{$.off("newDirectMessage",P),$.off("directMessagesRead",E),$.off("allDirectMessagesRead",k)}},[i._id,n._id]),W.useEffect(()=>{c||L()},[o,c]);const C=async()=>{try{g(!0);const P=await gt(i._id,1,20);P.success&&P.data&&(a(P.data.messages),v(P.data.hasMore))}catch(P){console.error("Failed to load direct messages:",P)}finally{g(!1)}},N=async()=>{if(!(l||!u))try{g(!0);const P=w+1,E=await gt(i._id,P,20);E.success&&E.data&&(a(k=>[...E.data.messages,...k]),v(E.data.hasMore),M(P))}catch(P){console.error("Failed to load more messages:",P)}finally{g(!1)}},T=async()=>{try{await qt(i._id),$.emit("markAllDirectMessagesAsRead",{senderId:i._id})}catch(P){console.error("Failed to mark messages as read:",P)}},L=Ft.useCallback(()=>{s.current?.scrollIntoView({behavior:"smooth"})},[]),F=P=>{const{scrollTop:E}=P.currentTarget;E===0&&u&&N()},B=P=>new Date(P).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),I=P=>{const E=new Date(P),k=new Date,A=new Date(k);return A.setDate(A.getDate()-1),E.toDateString()===k.toDateString()?"Today":E.toDateString()===A.toDateString()?"Yesterday":E.toLocaleDateString()},U=(P,E)=>{if(!E)return!0;const k=new Date(P.createdAt).toDateString(),A=new Date(E.createdAt).toDateString();return k!==A},q=!!r&&r.has(i._id);return t?R.jsx(ye,{size:{width:c?300:500,height:c?60:600},position:{x:D,y:p},onDragStart:()=>m(!0),onDragStop:(P,E)=>{m(!1),y(E.x),d(E.y)},onResizeStart:()=>b(!0),onResizeStop:(P,E,k,A,V)=>{b(!1),y(V.x),d(V.y)},minWidth:c?100:500,minHeight:c?60:400,maxWidth:600,maxHeight:700,bounds:"window",dragHandleClassName:"dm-window-header",className:`z-50 ${f||x?"":"transition-all duration-300"}`,children:R.jsxs("div",{className:"h-full bg-white/10 backdrop-blur-md rounded-lg border border-white/20 shadow-xl overflow-hidden flex flex-col transition-all duration-300",children:[R.jsx(Gt,{otherUser:i,isOnline:q,isMinimized:c,onMinimize:()=>S(P=>!P),onClose:e}),c?R.jsx(Vt,{otherUser:i,isOnline:q,onRestore:()=>S(!1)}):R.jsxs(R.Fragment,{children:[R.jsx($t,{messages:o,currentUser:n,formatDate:I,formatTime:B,shouldShowDateSeparator:U,messagesEndRef:s,messagesContainerRef:h,handleScroll:F,loading:l,page:w,hasMore:u,loadMoreMessages:N}),R.jsx(Ut,{onSend:(P,E)=>{E&&(!P||P==="<br>"||P.trim()==="")?($.emit("sendDirectMessage",{receiverId:i._id,content:"",imageUrl:E}),setTimeout(()=>L(),300)):P&&P!=="<br>"&&P.trim()!==""&&($.emit("sendDirectMessage",{receiverId:i._id,content:P}),setTimeout(()=>L(),300))}})]})]})}):null};export{_e as DMWindow,Gt as DMWindowHeader,Ut as DMWindowInput,$t as DMWindowMessages,Vt as DMWindowMinimized,_e as default};
